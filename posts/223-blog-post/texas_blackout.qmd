---
title: "Identifying the Impacts of Extreme Weather"
description: "Analysis of Houston Blackouts and its socioeconomic impacts"
author: 
  - name: Hylaea Miller
    url: https://hylaea-miller.github.io/
    affiliation: Bren School of Environmental Science & Management
    orcid: 0009-0003-5381-004X
date: 2025-12-06
categories: [GEOSPATIAL, R, data-viz]
citation: 
  url: https://github.com/hylaea-miller/Identifying-the-impacts-of-extreme-weather.git
draft: false
draft-mode: linked
bibliography: references.bib
execute: 
  message: false
  warning: false
  output: false
format:
  html:
    code-fold: true
---
## Research Question

To what extent did the February 2021 Texas winter storm blackouts disproportionately affect low-income communities in the Houston metropolitan area?

## Background

Climate change is increasing the frequency and intensity of extreme weather events, with devastating impacts on infrastructure and communities. In February 2021, Texas experienced a major power crisis resulting from three severe winter storms that swept across the United States between February 10-20, leaving millions without power for days in freezing temperatures[^1].

In this blog post, I identify the impacts of these series of extreme winter storms by estimating the number of homes in the Houston metropolitan area that lost power and investigate whether these impacts were disproportionately felt by low-income populations.

[^1]: 2021 Texas Power Grid Failure – a preventable disaster. DEITABASE. Last modified 2024, December 27. <https://limos.engin.umich.edu/deitabase/2024/12/27/2021-texas-power-grid-failure/>.

## Data

-   **Night lights**: Imagery from the Visible Infrared Imaging Radiometer Suite (VIIRS) distributed through NASA’s [Level-1 and Atmospheric Archive & Distribution System Distributed Active Archive Center (LAADS DAAC)](https://ladsweb.modaps.eosdis.nasa.gov/)

-   **Roads**: Data from [Geofabrik’s](https://download.geofabrik.de/) download site was used to retrieve a shapefile of all highways in Texas, and a Geopackage (.gpkg file) was prepared containing only the subset of roads that intersect the Houston metropolitan area.

-   **Houses**, Data from [Geofabrik’s](https://download.geofabrik.de/) download site was used to retrieve a shapefile of all houses in Texas, and a Geopackage (.gpkg file) was prepared containing only the subset of houses that intersect the Houston metropolitan area.

-   **Socioeconomic** From the U.S. Census Bureau’s American Community Survey for census tracts in 2019, which contains social, economic, housing, and demographic information across the 50 states of the U.S., the District of Columbia, and Puerto Rico. The dataset can be found here: [Census](https://www.census.gov/programs-surveys/acs)

## Load Packages

```{r}
#| output: false
# Load libraries 
library(tidyverse)
library(stars)
library(sf)
library(here)
library(dplyr)
library(raster) 
library(terra)
library(tmap)
library(paletteer)
```

## Import Data

1.  Import the datasets: Night lights (`rt`), Roads, Houses (`buildings`) and Socioeconomic data

```{r}
# Read raster tiles for both dates
# Raster tile collected 2021-02-07 - before storm
rt_0705 <- read_stars(here("data", "VNP46A1",
                           "VNP46A1.A2021038.h08v05.001.2021039064328.tif"))
rt_0706 <- read_stars(here("data", "VNP46A1", 
                           "VNP46A1.A2021038.h08v06.001.2021039064329.tif"))

# Raster tile collected 2021-02-16  - after storm
rt_1605 <- read_stars(here("data", "VNP46A1", 
                           "VNP46A1.A2021047.h08v05.001.2021048091106.tif"))
rt_1606 <- read_stars(here("data", "VNP46A1", 
                           "VNP46A1.A2021047.h08v06.001.2021048091105.tif"))

# Read roads data
roads <- st_read(here("data",
       "gis_osm_roads_free_1.gpkg"),
  query = "SELECT * FROM gis_osm_roads_free_1 WHERE fclass='motorway'") %>% 
  st_transform(crs = "epsg:3083")


# Read building data
buildings <- st_read(here("data",
                          "gis_osm_buildings_a_free_1.gpkg"),
  query = " SELECT *
    FROM gis_osm_buildings_a_free_1
    WHERE (type IS NULL AND name IS NULL)
      OR type IN ('residential', 'apartments', 'house', 'static_caravan', 
  'detached')")


# List layers of the socioeconomic data
texas_layers <- st_layers(here("data/ACS_2019_5YR_TRACT_48_TEXAS.gdb"))

# Read the layers holding the Texas geometry information
texas_geom <- st_read(here("data/ACS_2019_5YR_TRACT_48_TEXAS.gdb"),
                layer = "ACS_2019_5YR_TRACT_48_TEXAS")

texas_income <- st_read(here("data/ACS_2019_5YR_TRACT_48_TEXAS.gdb"),
                         layer = "X19_INCOME",
                         query = "SELECT B19013e1, GEOID FROM X19_INCOME") %>%
  mutate(GEOID_Data = GEOID)

```

## Find locations that experienced a blackout by creating a mask

Combine the raster tiles from each observation date

```{r}
# Merge tiles from February 7, 2021
mosaic_7 <- st_mosaic(rt_0705, rt_0706)
# Merge tiles from February 16, 2021
mosaic_16 <- st_mosaic(rt_1605, rt_1606)
```

### Visualization of Night Light Changes

Maps comparing night light intensities before and after the storms

```{r}
#| output: true
# Create color palette for the night lights
pal_lights <- c("#000011", "#000066", "#2222AA", "#FFFF66", "#FFFFFF")

# Plot raster of night lights before the storms
map_before <- tm_shape(mosaic_7) +
  tm_raster(palette = pal_lights,
            style = "quantile", 
            title = "Light Intensity(nW cm⁻²sr⁻¹)") +
  tm_title(text = "Night Lights\nFebruary 07, 2021 (Before storm)", size = 0.7)+
  tm_graticules()+
  tm_layout(inner.margins = c(0.001, 0.001, 0.001, 0.001),
            component.autoscale = FALSE,
            legend.text.size = 0.5,
            legend.title.size = 0.5,)

# Plot raster of night lights after the storms
map_after <- tm_shape(mosaic_16) +
  tm_raster(palette = pal_lights,
            style = "quantile", 
            title = "Light Intensity(nW cm⁻²sr⁻¹)") +
  tm_title(text = "Night Lights\nFebruary 16, 2021 (After storm)", size = 0.7)+
  tm_graticules() +
  tm_layout(inner.margins = c(0.001, 0.001, 0.001, 0.001),
            component.autoscale = FALSE,
            legend.text.size = 0.5,
            legend.title.size = 0.5,)

tmap_arrange(map_before, map_after, nrow = 1)

```

### Find the change in night lights intensity caused by the storm

Calculate light intensity difference between dates

```{r}
# Subtract light intensity (February 7 - February 16)
difference <- mosaic_7 - mosaic_16
```

### Create blackout mask using classification

Reclassify the difference raster, assigning NA to locations that experienced a drop of less than 200 nW cm⁻²sr⁻¹.

```{r}

#  keep only locations with light drops > 200 nW cm⁻²sr⁻¹
lights_mask_diff <- difference
lights_mask_diff[difference < 200] <- NA

```

Vectorize the blackout mask for spatial analysis

```{r}
# Vectorize mask and ensure valid geometry
mask_vec <- st_as_sf(lights_mask_diff, as_points = FALSE, merge = TRUE) %>% 
  st_make_valid() %>% 
  st_as_sf(crs = 'EPSG:3083')

```

Define and create a bounding box for the Houston Area

```{r}
# Define coordinates of Houston
lon <- c(-96.5, -96.5, -94.5, -94.5)
lat <- c(29, 30.5, 30.5, 29)

# Create bbox from min and max of lon and lat
houston_bbox <- st_bbox(c(
  xmin = min(lon),
  ymin = min(lat),
  xmax = max(lon),
  ymax = max(lat)), crs = st_crs(mask_vec))

```

Crop and reproject blackout mask to Houston area

```{r}
# Crop the blackout mask to the Houston bounding box
cropped_blackout <-  st_crop(mask_vec, houston_bbox) %>% 
st_make_valid() %>% 
  st_transform(cropped_blackout, crs = "epsg:3083")
```

## Exclude highways from analysis

Check CRS Units of highways Layer

```{r}
#| output: true
# Verify units of the highways
st_crs(roads)$units
```

Create 200m Buffer Around Highways

```{r}
# create a 200m buffer around highways and dissolve overlapping areas
roads_buffer <- st_buffer(roads, dist = 200) %>% 
st_union
```

Transform coordinate reference systems to match

```{r}
# Check if the datasets have the same coordinate reference system.
# If not, print a warning and transform the second dataset to match the first.
if(st_crs(cropped_blackout) != st_crs(roads_buffer)){
  warning("coordinate reference systems do not match")
  roads_buffer <- st_transform(roads_buffer, crs = st_crs(cropped_blackout))
}
```

```{r}
# Verify that the CRS transformation was successful
print(st_crs(cropped_blackout) == st_crs(roads_buffer)) # True
```

Extract blackout areas outside highways

```{r}

# Ensure the blackout layer has valid geometries
cropped_blackout <- st_make_valid(cropped_blackout)

# Ensure the roads buffer layer has valid geometries
roads_buffer <- st_make_valid(roads_buffer)

# Subtract the roads buffer from the blackout
blackout_not_road <- st_difference(cropped_blackout, roads_buffer)
```

## Identify homes that experienced blackouts by combining the locations of homes and blackouts

Transform coordinate reference systems to match

```{r}
# Check if the datasets have the same coordinate reference system.
# If not, print a warning and transform the second dataset to match the first.
if(st_crs(blackout_not_road) != st_crs(buildings)){
  warning("coordinate reference systems do not match")
  buildings <- st_transform(buildings, crs = st_crs(blackout_not_road))
}
```

Select homes located within blackout areas

```{r}
# Select homes that overlap with blackout_not_road.
homes_blackout <- buildings[blackout_not_road, 
                     op = st_intersects, 
                     drop = FALSE] 
```

### Map of the homes in Houston that lost power

```{r}
#| output: true

# Plot a map of homes affected by the blackout
map_homes_blackout <- tm_shape(homes_blackout) +
  tm_polygons(col = "#480091") +
  tm_title(text = "Homes in Houston that lost power") +
  tm_graticules() +
  tm_basemap("OpenStreetMap", alpha = 0.7) +
  tm_layout(inner.margins = c(0.01, 0.01, 0.01, 0.1),
            component.autoscale = FALSE) +
  tm_add_legend(type = "fill",
                labels = "Homes Affected",
                col = "#480091",
                title = "Legend")

map_homes_blackout
```

### Verify an estimate of the number of homes in Houston that lost power

```{r}
#| output: true

# Count the number of homes that lost power
length(homes_blackout$fclass)
```

The estimated number of houses that lost power is 157,970. I used the `st_intersects` operation, which considers homes even if they are only partially within the blackout area.

## Identify the census tracts likely impacted by blackout

Join the census geometry with the median income data (texas_income)

```{r}
# Left join geometry and median income layers
inc_geom <- left_join(texas_geom, texas_income, by = "GEOID_Data") %>% 
  st_transform(crs = "epsg:3083")
```

Transform Houston bounding box to match CRS

```{r}
# Transform CRS
houston_bbox <- houston_bbox %>% 
  st_transform(crs = "epsg:3083")
```

Crop census to Houston bbox area

```{r}
# Crop income layer to the Houston bounding box
houston_income <- st_crop(inc_geom, houston_bbox) %>% 
st_make_valid() %>% 
  st_transform(houston_income, crs = "epsg:3083")
```

### Map of the census tracts in Houston that lost power

Check CRS compatibility before performing spatial operations.

```{r}
# Verify that both datasets use the same CRS and add a stop error if they don't
if(st_crs(houston_income) != st_crs(homes_blackout)){
    stop("coordinate reference systems must match to join datasets")}
```

Use `st_intersects` to find the census tracts that overlap with the homes affected by the blackout, including those partly inside the affected area.

```{r}
# Intersect census tracts with blackout areas
homes_census_blackout <- houston_income[homes_blackout,
                               op = st_intersects]

```

Map of the spatial distribution of median household income across census tracts that experienced blackout in Houston.

```{r}
#| output: true
# Create map showing median income for blackout-affected census tracts
tm_shape(homes_census_blackout) +
  tm_fill(
    col = "B19013e1",
    palette = "Reds",              
    title = "Median Income") + 
 tm_basemap(server = "OpenStreetMap", alpha = 0.7) +
 tm_graticules() +
 tm_title(text = "Median Income by Census Tract for Houses
          Affected by the Blackout in Houston" )

```

## Find census tracts that did not experience blackout

Create combined dataset with blackout status for all census tracts

```{r}

# Compare all Houston tracts against those identified with blackouts,
# Remove geometry and select only income and status variables
census_combined <- houston_income %>%
  mutate(blackout_status = if_else(GEOID_Data %in% homes_census_blackout$GEOID_Data, 
                                   "Blackout", "No Blackout")) %>%
  st_drop_geometry() %>%
  dplyr::select(B19013e1, blackout_status) %>%
  drop_na()

```

Visualize the distribution of median household income across census tracts to determine if the blackout disproportionately impacted certain socioeconomic groups.

```{r}
#| output: true
# Plot income distribution by blackout status
ggplot() +
  geom_boxplot(data = census_combined,
           aes(x = blackout_status, 
               y = B19013e1,
               fill = blackout_status)) +
  scale_x_discrete(labels=c("Blackout", "No Blackout")) +
  scale_fill_manual(values = c("#2955AA", "#F9cF66"),
                    name = "Blackout Status") +
  labs(x = "Affected Status",
       y = "Median Income of Census Tract",
       title = "Distribution of Median Income in Areas Affected 
       and Unaffected by Blackout in Houston") +
  theme_minimal()

```

## Conclusion and Next Steps

The results show that median household incomes are similar between census tracts that experienced blackouts and those that did not, suggesting that income level was not a strong factor in determining which areas lost power during the storm. However, we need to consider some limitations of this result, as they relate to the spatial scale and join methods used in our analysis. Some possible bias in the results may be related to the concentration of buildings in the central part of Houston affected by blackouts, as shown in the Homes Map, and the reliance on tract-level overlaps that generalize patterns and hide smaller spatial or demographic variations.

## Data Citations

Home - LAADS DAAC. (2017, February 22). Nasa.gov. https://ladsweb.modaps.eosdis.nasa.gov/

Download OpenStreetMap for OpenStreetMap Data Extracts \| Geofabrik Download Server. (2025). Geofabrik Download Server. https://download.geofabrik.de/

Bureau, U. C. (2025, September 29). American Community Survey (ACS). Census.gov. https://www.census.gov/programs-surveys/acs

DEITABASE. (2024, December 27). 2021 Texas Power Grid Failure – a preventable disaster. DEITABASE - a Community Resource for Merging DEI and CEE Education. https://limos.engin.umich.edu/deitabase/2024/12/27/2021-texas-power-grid-failure/
