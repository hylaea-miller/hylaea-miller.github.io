{
  "hash": "708e09ebf7c97ec43959b452779df910",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analyzing Deforestation Drivers in MATOPIBA, Brazil\"\nauthor: \"Hylaea Miller\"\ndate: 12/04/2025\nformat:\n  html:\n    code-fold: true\neditor: visual\nexecute:\n  echo: true\n  message: false\n  warning: false\n---\n\n## Background\n\nThe MATOPIBA region, an acronym formed from the Brazilian states of Maranhão, Tocantins, Piauí, and Bahia, is located in the northeastern and central parts of Brazil and encompasses areas of the Cerrado biome, a biodiversity-rich tropical savanna. Changes in land use and land cover in the MATOPIBA region have shown a high incidence of agricultural activities (Miranda et al., 2014), indicating an increase in the conversion of native vegetation.\n\nUsing MapBiomas data from 1987 to 2024, this project evaluates the temporal evolution of native vegetation loss and examines how key drivers, such as farming, fire occurrence, mining, and urban expansion,contribute to deforestation patterns. To support this assessment, a Gamma regression model was employed to analyze the magnitude and distribution of vegetation suppression and identify the factors most strongly associated with it in MATOPIBA.\n\n## Research Question\n\nWhat are the main drivers of deforestation in the MATOPIBA region of Brazil between 1987 and 2024?\n\n## Data Collection\n\nThe data used in this project was collected in the MapBiomas platform, you can find it here by accessing their dashbord and specifying the MATIPIBA region: [MapBiomas](https://plataforma.brasil.mapbiomas.org)\n\n### Datasets Description\n\n-   **Deforestation (Vegetation Suppression)**\n\nThis dataset contains annual information on the suppression of primary and secondary vegetation. It quantifies the total area (in hectares) converted from natural vegetation to anthropogenic land use each year in MATOPIBA.\n\n-   **Land Use and Land Cover (LULC)**\n\nThe LULC dataset provides the annual classification of land cover and land use across different categories such as forest, savanna, grassland, agriculture, pasture, urban, mining and other classes.\n\n-   **Fire**\n\nThis dataset records the total annual burned area for MATOPIBA, indicating the extent of fire events.\n\n### Variable relationship\n\n**Variable description**\n\nThe following variables were used in this project:\n\n-   **Deforestation**: Annual sum of primary and secondary vegetation loss, measured in hectares.\n\n-   **Urban**: Annual change in urban area, measured in hectares.\n\n-   **Farming:** Annual change in the combined agricultural and livestock farming area, measured in hectares.\n\n-   **Mining:** Annual change in mining area, measured in hectares.\n\n-   **Fire:** Total burned area per year, measured in hectares.\n\n![](images/clipboard-3591819254.png){width=\"510\"}\n\n### Data Exploration and Tidying\n\nImport libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidyterra)\nlibrary(readr)\nlibrary(kableExtra)\n```\n:::\n\n\nRead data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read data\nfire_ma <- read_csv(\"data/Série temporal de Fogo • Anual por classe • 1985 - 2024.csv\")\n\ndeforestation_ma <- read_csv(\"data/Série temporal de Desmatamento • Anual por classe • 1985 - 2024.csv\")\n\ncobertura_ma <- read_csv(\"data/Série temporal de Cobertura • Cobertura por classe • 1985 - 2024.csv\")\n```\n:::\n\n\nClean the datasets using a function\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to clean and convert all columns in a dataframe to numeric\nconvert_to_numeric <- function(df) {\n  df %>%\n    mutate(across(everything(), ~ .x %>%\n                    str_remove_all(\" \") %>%\n                    str_remove_all(\"\\\\.\") %>%\n                    na_if(\"\") %>%\n                    na_if(\"NA\") %>%\n                    as.numeric() %>%\n                    suppressWarnings()))\n}\n```\n:::\n\n\nApply function to all datasets\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Apply cleaning function\nfire <- convert_to_numeric(fire_ma)\nlulc <- convert_to_numeric(cobertura_ma)\ndeforestation <- convert_to_numeric(deforestation_ma)\n```\n:::\n\n\nCalculate total farming area to use as response variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Sum agriculture and livestock farming columns to have the total of farming\n\nlulc <- lulc %>%\n  mutate(total_farming = rowSums(across(12:23), na.rm = TRUE)) \n\n# Sum primary and secondary deforestation\ndeforestation <- deforestation %>% \n  mutate(total_deforestation = rowSums(across(2:3), na.rm = TRUE))\n```\n:::\n\n\nCorrect urban area data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fix missing decimal in urban area column by multiplying by 10 \nlulc <- lulc %>%  \nmutate(urban_area = case_when(\n    row_number() %in% c(10, 22, 39) ~ `Área Urbanizada` * 10,\n    TRUE ~ `Área Urbanizada`))\n```\n:::\n\n\nCalculate annual changes in land use\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate year changes in LULC variables\nlulc <- lulc %>%\n  mutate(\n    change_farming = total_farming - lag(total_farming),\n    change_mining = `Mineração` - lag(`Mineração`),\n    change_urban = urban_area - lag(urban_area))\n```\n:::\n\n\nMerge datasets and filter\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Join datasets\n\nmatopiba_join <- deforestation %>% left_join(lulc, by = \"Ano\")\n\nmatopiba = matopiba_join %>% \nleft_join(fire, by = \"Ano\") %>% \n  filter(total_deforestation > 0, !is.na(total_deforestation)) %>% \n  rename(total_fire = `Total queimado`)\n```\n:::\n\n\n### Plot relationship between the response and predictor variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(matopiba, aes(x = total_fire, y = total_deforestation )) +\n  geom_point(color = \"darkblue\", size = 3, alpha = 0.7) +\n  geom_smooth(method = \"glm\", se = TRUE, color = \"firebrick\") +\n  theme_minimal() +\n  labs(\n    title = \"Relationship Between fire and deforestation in MATOPIBA (1987-2024)\",\n    x = \"Burned area per year (ha)\",\n    y = \"Deforestation (ha)\")\n```\n\n::: {.cell-output-display}\n![](deforestation_drivers_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(matopiba, aes(x = change_farming, y = total_deforestation )) +\n  geom_point(color = \"darkorange\", size = 3, alpha = 0.7) +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"firebrick\") +\n  theme_minimal() +\n  labs(\n    title = \"Relationship Between Farming and deforestation in MATOPIBA (1987-2024)\",\n    x = \"Change in Farming Area per year (ha)\",\n    y = \"Deforestation per year (ha)\"\n  )\n```\n\n::: {.cell-output-display}\n![](deforestation_drivers_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(matopiba, aes(x = change_mining, y = total_deforestation)) +\n  geom_point(color = \"purple\", size = 3, alpha = 0.7) +\n  geom_smooth(method = \"glm\", se = TRUE, color = \"firebrick\") +\n  theme_minimal() +\n  labs(\n    title = \"Relationship Between Mining and Deforestation in MATOPIBA (1987-2024)\",\n    x = \"Change in Mining Area per Year (ha)\",\n    y = \"Deforestation Area per year (ha)\" )\n```\n\n::: {.cell-output-display}\n![](deforestation_drivers_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(matopiba, aes(x = change_urban, y = total_deforestation)) +\n  geom_point(color = \"darkgreen\", size = 3, alpha = 0.7) +\n  geom_smooth(method = \"glm\", se = TRUE, color = \"firebrick\") +\n  theme_minimal() +\n  labs(\n    title = \"Relationship Between Urban Area and Deforestation in MATOPIBA (1987-2024)\",\n    x = \"Change in Urban Area per Year (ha)\",\n    y = \"Deforestation per year (ha)\")\n```\n\n::: {.cell-output-display}\n![](deforestation_drivers_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Statistical Model\n\nI choose to model the annual vegetation loss, a continuous, and positive variable using a Gamma regression with a log link. The Gamma distribution is appropriate because vegetation loss is skewed to the right, and consist of positive numbers.\n\nThe model assumes that vegetation loss increases or decreases with predictors such as agriculture, fire, mining, and urbanization. Using a log link means each coefficient represents the percentage change in expected deforestation for a one-unit change in a predictor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histogram to check distribution and skewness of deforestation data\nggplot(matopiba, aes(x = total_deforestation)) +\n  geom_histogram(bins = 10, fill = \"darkgreen\", color = \"black\", alpha = 0.7) +\n  geom_vline(aes(xintercept = mean(total_deforestation, na.rm = TRUE), color = \"Mean\"), linewidth = 1.5) +\n  geom_vline(aes(xintercept = median(total_deforestation, na.rm = TRUE), color = \"Median\"), linewidth = 1.5) +\n  scale_color_manual(name = \"\", \n                     values = c(\"Mean\" = \"red\", \"Median\" = \"blue\")) +\n  theme_minimal() +\n  labs(\n    title = \"Distribution of Total Deforestation in MATOPIBA (1987-2024)\",\n    x = \"Total Deforestation (ha)\",\n    y = \"Frequency\") \n```\n\n::: {.cell-output-display}\n![](deforestation_drivers_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n**Gamma model notation**\n\n$$\n\\begin{align}\n\\text{Deforestation} &\\sim Gamma(\\mu, ϕ) \\\\\nlog(\\mu) &= \\beta_0 + \\beta_1 \\text{Farming} + \\beta_2 \\text{Urban} + \\beta_3 \\text{Mining} + \\beta_4 \\text{Fire}\n\\end{align}\n$$\n\n### Simulate Data According to the Model Assumptions\n\nChoose parameters and predictors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n\n# Simulate number of observations\nn <- 500\n\n# Choose true parameter values\nbeta0 <- 1\nbeta1 <- 2   # farming effect\nphi <- 4     # shape parameter\n\n# Simulate predictor variable by generating random deviates\nfarming <- runif(n, min = 0, max = 50)\n\n# Simulate Gamma distributed response with log linear mean\ndeforestation_sim <- rgamma(n, shape = phi, scale = exp(beta0 + beta1*farming)/phi)\n\n# Combine into a data frame\nsim_data <- tibble(deforestation_sim, farming)\n```\n:::\n\n\n### Fit the Model to the Simulated Data and Show Parameter Recovery\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit Gamma GLM to simulated data\nfit <- glm(deforestation_sim ~ farming,\n  family = Gamma(link = \"log\"),\n  data = sim_data)\n```\n:::\n\n\nCompare estimated vs true parameters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the estimated and true parameters\ntrue_params <- c(beta0, beta1)\nest_params  <- coef(fit)\n\n# Create a dataframe comparing true and estimated values\ndf_sim <- tibble(parameter = names(est_params),\n  true_value = round(true_params, 3),\n  estimated  = round(est_params, 3))\n```\n:::\n\n\nCreate model parameter comparison table\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Display comparison table \ndf_sim %>%\n  kbl(caption = \"Estimated vs true parameters\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Estimated vs true parameters</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> parameter </th>\n   <th style=\"text-align:right;\"> true_value </th>\n   <th style=\"text-align:right;\"> estimated </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.035 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> farming </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.998 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Inference\n\nH₁: In the MATOPIBA region, increases in agricultural land use, fire area incidence, mining area activity, and urban expansion are associated with higher levels of native vegetation loss.\n\nH₀: These land-use drivers have no significant association with native vegetation loss in MATOPIBA.\n\n### Fit the Gamma Regression Model\n\nFit a Gamma GLM with log link to model total deforestation in MATOPIBA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_gamma <- glm(total_deforestation ~ change_farming + change_urban + change_mining + total_fire,\n                   data = matopiba, \n                   family = Gamma(link = \"log\"))\nsum_model <- summary(model_gamma)\n```\n:::\n\n\nExtract model coefficients\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(model_gamma)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   (Intercept) change_farming   change_urban  change_mining     total_fire \n  1.276162e+01   1.122991e-06   2.411644e-05   8.424645e-04   2.416640e-09 \n```\n\n\n:::\n:::\n\n\nExtract model confidence interval\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(model_gamma)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                       2.5 %       97.5 %\n(Intercept)     1.249961e+01 1.302462e+01\nchange_farming  8.731579e-07 1.376317e-06\nchange_urban   -3.557639e-05 8.395461e-05\nchange_mining  -1.387431e-03 3.120978e-03\ntotal_fire     -1.570257e-08 2.074489e-08\n```\n\n\n:::\n:::\n\n\nCreate prediction grid\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create pred_grid with all variables, holding others at their mean\npred_farming <- expand_grid(\n  change_farming = seq(\n    min(matopiba$change_farming, na.rm = TRUE),\n    max(matopiba$change_farming, na.rm = TRUE),\n    length.out = 100 ),\n  change_urban = mean(matopiba$change_urban, na.rm = TRUE),      \n  change_mining = mean(matopiba$change_mining, na.rm = TRUE),    \n  total_fire = mean(matopiba$total_fire, na.rm = TRUE))\n\n# Generate predictions \nclass_model_pred <- pred_farming %>% \n  mutate(predicted_deforestation = predict(object = model_gamma,\n                                           newdata = pred_farming,\n                                           type = \"response\"))\n```\n:::\n\n\nCalculate standard errors on link scale\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_se <- predict(object = model_gamma,\nnewdata = pred_farming,\ntype = 'link',\nse.fit = TRUE)\n```\n:::\n\n\nCalculate confidence intervals for predictions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the link inverse function from the MODEL \nlinkinv <- family(model_gamma)$linkinv  \n\n# Generate the predictions with confidence intervals\nclass_model_pred <- pred_farming %>%\n  mutate(\n# Predictions on link scale\n    log_l = model_se$fit,\n# Standard error on link scale\n    log_se = model_se$se.fit,\n# 95% CI on link scale using quantiles\n    log_lwr = qnorm(0.025, mean = log_l, sd = log_se),\n    log_upr = qnorm(0.975, mean = log_l, sd = log_se),\n# Transform from link space to response space\n    fit = linkinv(log_l),     \n    lwr = linkinv(log_lwr),\n    upr = linkinv(log_upr))\n```\n:::\n\n\nVisualize farming change effect on deforestation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  # Confidence ribbon\n  geom_ribbon(\n    data = class_model_pred,\n    aes(x = change_farming, ymin = lwr, ymax = upr),\n    fill = \"#143399\", alpha = 0.4) +\n  # Fitted line\n  geom_line(\n    data = class_model_pred,\n    aes(x = change_farming, y = fit),\n    color = \"firebrick\", linewidth = 1.5) +\n  # Observed data\n  geom_point(\n    data = matopiba,\n    aes(x = change_farming, y = total_deforestation),\n    color = \"darkorange\", size = 3, alpha = 0.6) +\n  labs(\n    title = \"Gamma Regression: Farming Change vs Vegetation Suppression\",\n    x = \"Annual Change in Farming Area (ha/year)\",\n    y = \"Annual Deforestation (ha/year)\" ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](deforestation_drivers_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n## Results\n\n## Table: Gamma Regression Model Results\n\n| Variable          | Estimate  | Std. Error | p-value  | 95% CI Lower | 95% CI Upper |     |\n|-------------------|-----------|------------|----------|--------------|--------------|-----|\n| Intercept         | 1.276e+01 | 1.343e-01  | \\< 2e-16 | 1.250e+01    | 1.302e+01    |     |\n| Change in Farming | 1.123e-06 | 1.310e-07  | 6.55e-10 | 8.732e-07    | 1.376e-06    |     |\n| Change in Urban   | 2.412e-05 | 3.112e-05  | 0.444    | -3.558e-05   | 8.395e-05    |     |\n| Change in Mining  | 8.425e-04 | 1.160e-03  | 0.473    | -1.387e-03   | 3.121e-03    |     |\n| Total Fire        | 2.417e-09 | 9.236e-09  | 0.795    | -1.570e-08   | 2.074e-08    |     |\n\n### Model Results Interpretation\n\n-   **Change in Farming (significant)**\n\n**Estimate:** 1.123e-06 (p \\< 0.001)\n\n**Interpretation:** For every 1-hectare increase in farming area, deforestation increases by approximately 0.0001% (exp(1.123e-06) ≈ 1.000001)\n\n**95% CI:** \\[8.66e-07, 1.38e-06\\] (approximate)\n\n-   **Change in Urbanization (not significant)**\n\n**Estimate:** 2.412e-05 (p = 0.444)\n\n**Interpretation:** No statistically significant relationship between urban expansion and accumulated deforestation\n\n-   **Change in Mining (not significant)**\n\n**Estimate:** 8.425e-04 (p = 0.473)\n\n**Interpretation:** No statistically significant relationship between mining expansion and accumulated deforestation\n\n-   **Total Burned Area (not significant)**\n\n**Estimate:** 2.417e-09 (p = 0.795)\n\n**Interpretation:** No statistically significant relationship between burned area and accumulated deforestation\n\n## Conclusion\n\nThe results provide strong evidence that farming expansion is the primary driver of deforestation in this model, whereas urban area change, mining, and fire showed no significant influence.\n\n## References\n\nMapBiomas, Mapbiomas.org. https://plataforma.brasil.mapbiomas.org\n\nMiranda, E. E., Magalhães, L. A., Carvalho, C. A. (2014). Proposta de Delimitação Territorial do MATOPIBA. Embrapa. https://www.infoteca.cnptia.embrapa.br/infoteca/bitstream/doc/1037313/1/NT1DelimitacaoMatopiba.pdf\n\nGetting Started with Gamma Regression \\| UVA Library. (2025). Virginia.edu. https://library.virginia.edu/data/articles/getting-started-with-gamma-regression\n",
    "supporting": [
      "deforestation_drivers_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}