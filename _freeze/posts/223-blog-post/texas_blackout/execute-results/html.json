{
  "hash": "2e99260ccc7401660c07433207639955",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Identifying the Impacts of Extreme Weather\"\ndescription: \"Analysis of Houston Blackouts and its socioeconomic impacts\"\nauthor: \n  - name: Hylaea Miller\n    url: https://hylaea-miller.github.io/\n    affiliation: Bren School of Environmental Science & Management\n    orcid: 0009-0003-5381-004X\ndate: 2025-12-06\ncategories: [GEOSPATIAL, R, data-viz]\ncitation: \n  url: https://github.com/hylaea-miller/Identifying-the-impacts-of-extreme-weather.git\ndraft: false\ndraft-mode: linked\nbibliography: references.bib\nexecute: \n  message: false\n  warning: false\n  output: false\nformat:\n  html:\n    code-fold: true\n---\n## Research Question\n\nTo what extent did the February 2021 Texas winter storm blackouts disproportionately affect low-income communities in the Houston metropolitan area?\n\n## Background\n\nClimate change is increasing the frequency and intensity of extreme weather events, with devastating impacts on infrastructure and communities. In February 2021, Texas experienced a major power crisis resulting from three severe winter storms that swept across the United States between February 10-20, leaving millions without power for days in freezing temperatures[^1].\n\nIn this blog post, I identify the impacts of these series of extreme winter storms by estimating the number of homes in the Houston metropolitan area that lost power and investigate whether these impacts were disproportionately felt by low-income populations.\n\n[^1]: Wikipedia. 2021. \"2021 Texas power crisis.\" Last modified October 2, 2021. <https://limos.engin.umich.edu/deitabase/2024/12/27/2021-texas-power-grid-failure/>.\n\n## Data\n\n-   **Night lights**: Imagery from the Visible Infrared Imaging Radiometer Suite (VIIRS) distributed through NASA’s [Level-1 and Atmospheric Archive & Distribution System Distributed Active Archive Center (LAADS DAAC)](https://ladsweb.modaps.eosdis.nasa.gov/)\n\n-   **Roads**: Data from [Geofabrik’s](https://download.geofabrik.de/) download site was used to retrieve a shapefile of all highways in Texas, and a Geopackage (.gpkg file) was prepared containing only the subset of roads that intersect the Houston metropolitan area.\n\n-   **Houses**, Data from [Geofabrik’s](https://download.geofabrik.de/) download site was used to retrieve a shapefile of all houses in Texas, and a Geopackage (.gpkg file) was prepared containing only the subset of houses that intersect the Houston metropolitan area.\n\n-   **Socioeconomic** From the U.S. Census Bureau’s American Community Survey for census tracts in 2019, which contains social, economic, housing, and demographic information across the 50 states of the U.S., the District of Columbia, and Puerto Rico. The dataset can be found here: [Census](https://www.census.gov/programs-surveys/acs)\n\n## Load Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries \nlibrary(tidyverse)\nlibrary(stars)\nlibrary(sf)\nlibrary(here)\nlibrary(dplyr)\nlibrary(raster) \nlibrary(terra)\nlibrary(tmap)\nlibrary(paletteer)\n```\n:::\n\n\n## Import Data\n\n1.  Import the datasets: Night lights (`rt`), Roads, Houses (`buildings`) and Socioeconomic data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read raster tiles for both dates\n# Raster tile collected 2021-02-07 - before storm\nrt_0705 <- read_stars(here(\"data\", \"VNP46A1\",\n                           \"VNP46A1.A2021038.h08v05.001.2021039064328.tif\"))\nrt_0706 <- read_stars(here(\"data\", \"VNP46A1\", \n                           \"VNP46A1.A2021038.h08v06.001.2021039064329.tif\"))\n\n# Raster tile collected 2021-02-16  - after storm\nrt_1605 <- read_stars(here(\"data\", \"VNP46A1\", \n                           \"VNP46A1.A2021047.h08v05.001.2021048091106.tif\"))\nrt_1606 <- read_stars(here(\"data\", \"VNP46A1\", \n                           \"VNP46A1.A2021047.h08v06.001.2021048091105.tif\"))\n\n# Read roads data\nroads <- st_read(here(\"data\",\n       \"gis_osm_roads_free_1.gpkg\"),\n  query = \"SELECT * FROM gis_osm_roads_free_1 WHERE fclass='motorway'\") %>% \n  st_transform(crs = \"epsg:3083\")\n\n\n# Read building data\nbuildings <- st_read(here(\"data\",\n                          \"gis_osm_buildings_a_free_1.gpkg\"),\n  query = \" SELECT *\n    FROM gis_osm_buildings_a_free_1\n    WHERE (type IS NULL AND name IS NULL)\n      OR type IN ('residential', 'apartments', 'house', 'static_caravan', \n  'detached')\")\n\n\n# List layers of the socioeconomic data\ntexas_layers <- st_layers(here(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\"))\n\n# Read the layers holding the Texas geometry information\ntexas_geom <- st_read(here(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\"),\n                layer = \"ACS_2019_5YR_TRACT_48_TEXAS\")\n\ntexas_income <- st_read(here(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\"),\n                         layer = \"X19_INCOME\",\n                         query = \"SELECT B19013e1, GEOID FROM X19_INCOME\") %>%\n  mutate(GEOID_Data = GEOID)\n```\n:::\n\n\n## Find locations that experienced a blackout by creating a mask\n\nCombine the raster tiles from each observation date\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Merge tiles from February 7, 2021\nmosaic_7 <- st_mosaic(rt_0705, rt_0706)\n# Merge tiles from February 16, 2021\nmosaic_16 <- st_mosaic(rt_1605, rt_1606)\n```\n:::\n\n\n### Visualization of Night Light Changes\n\nMaps comparing night light intensities before and after the storms\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create color palette for the night lights\npal_lights <- c(\"#000011\", \"#000066\", \"#2222AA\", \"#FFFF66\", \"#FFFFFF\")\n\n# Plot raster of night lights before the storms\nmap_before <- tm_shape(mosaic_7) +\n  tm_raster(palette = pal_lights,\n            style = \"quantile\", \n            title = \"Light Intensity(nW cm⁻²sr⁻¹)\") +\n  tm_title(text = \"Night Lights\\nFebruary 07, 2021 (Before storm)\", size = 0.7)+\n  tm_graticules()+\n  tm_layout(inner.margins = c(0.001, 0.001, 0.001, 0.001),\n            component.autoscale = FALSE,\n            legend.text.size = 0.5,\n            legend.title.size = 0.5,)\n\n# Plot raster of night lights after the storms\nmap_after <- tm_shape(mosaic_16) +\n  tm_raster(palette = pal_lights,\n            style = \"quantile\", \n            title = \"Light Intensity(nW cm⁻²sr⁻¹)\") +\n  tm_title(text = \"Night Lights\\nFebruary 16, 2021 (After storm)\", size = 0.7)+\n  tm_graticules() +\n  tm_layout(inner.margins = c(0.001, 0.001, 0.001, 0.001),\n            component.autoscale = FALSE,\n            legend.text.size = 0.5,\n            legend.title.size = 0.5,)\n\ntmap_arrange(map_before, map_after, nrow = 1)\n```\n\n::: {.cell-output-display}\n![](texas_blackout_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### Find the change in night lights intensity caused by the storm\n\nCalculate light intensity difference between dates\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Subtract light intensity (February 7 - February 16)\ndifference <- mosaic_7 - mosaic_16\n```\n:::\n\n\n### Create blackout mask using classification\n\nReclassify the difference raster, assigning NA to locations that experienced a drop of less than 200 nW cm⁻²sr⁻¹.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#  keep only locations with light drops > 200 nW cm⁻²sr⁻¹\nlights_mask_diff <- difference\nlights_mask_diff[difference < 200] <- NA\n```\n:::\n\n\nVectorize the blackout mask for spatial analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vectorize mask and ensure valid geometry\nmask_vec <- st_as_sf(lights_mask_diff, as_points = FALSE, merge = TRUE) %>% \n  st_make_valid() %>% \n  st_as_sf(crs = 'EPSG:3083')\n```\n:::\n\n\nDefine and create a bounding box for the Houston Area\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define coordinates of Houston\nlon <- c(-96.5, -96.5, -94.5, -94.5)\nlat <- c(29, 30.5, 30.5, 29)\n\n# Create bbox from min and max of lon and lat\nhouston_bbox <- st_bbox(c(\n  xmin = min(lon),\n  ymin = min(lat),\n  xmax = max(lon),\n  ymax = max(lat)), crs = st_crs(mask_vec))\n```\n:::\n\n\nCrop and reproject blackout mask to Houston area\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Crop the blackout mask to the Houston bounding box\ncropped_blackout <-  st_crop(mask_vec, houston_bbox) %>% \nst_make_valid() %>% \n  st_transform(cropped_blackout, crs = \"epsg:3083\")\n```\n:::\n\n\n## Exclude highways from analysis\n\nCheck CRS Units of highways Layer\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Verify units of the highways\nst_crs(roads)$units\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"m\"\n```\n\n\n:::\n:::\n\n\nCreate 200m Buffer Around Highways\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a 200m buffer around highways and dissolve overlapping areas\nroads_buffer <- st_buffer(roads, dist = 200) %>% \nst_union\n```\n:::\n\n\nTransform coordinate reference systems to match\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check if the datasets have the same coordinate reference system.\n# If not, print a warning and transform the second dataset to match the first.\nif(st_crs(cropped_blackout) != st_crs(roads_buffer)){\n  warning(\"coordinate reference systems do not match\")\n  roads_buffer <- st_transform(roads_buffer, crs = st_crs(cropped_blackout))\n}\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Verify that the CRS transformation was successful\nprint(st_crs(cropped_blackout) == st_crs(roads_buffer)) # True\n```\n:::\n\n\nExtract blackout areas outside highways\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ensure the blackout layer has valid geometries\ncropped_blackout <- st_make_valid(cropped_blackout)\n\n# Ensure the roads buffer layer has valid geometries\nroads_buffer <- st_make_valid(roads_buffer)\n\n# Subtract the roads buffer from the blackout\nblackout_not_road <- st_difference(cropped_blackout, roads_buffer)\n```\n:::\n\n\n## Identify homes that experienced blackouts by combining the locations of homes and blackouts\n\nTransform coordinate reference systems to match\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check if the datasets have the same coordinate reference system.\n# If not, print a warning and transform the second dataset to match the first.\nif(st_crs(blackout_not_road) != st_crs(buildings)){\n  warning(\"coordinate reference systems do not match\")\n  buildings <- st_transform(buildings, crs = st_crs(blackout_not_road))\n}\n```\n:::\n\n\nSelect homes located within blackout areas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select homes that overlap with blackout_not_road.\nhomes_blackout <- buildings[blackout_not_road, \n                     op = st_intersects, \n                     drop = FALSE] \n```\n:::\n\n\n### Map of the homes in Houston that lost power\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot a map of homes affected by the blackout\nmap_homes_blackout <- tm_shape(homes_blackout) +\n  tm_polygons(col = \"#480091\") +\n  tm_title(text = \"Homes in Houston that lost power\") +\n  tm_graticules() +\n  tm_basemap(\"OpenStreetMap\", alpha = 0.7) +\n  tm_layout(inner.margins = c(0.01, 0.01, 0.01, 0.1),\n            component.autoscale = FALSE) +\n  tm_add_legend(type = \"fill\",\n                labels = \"Homes Affected\",\n                col = \"#480091\",\n                title = \"Legend\")\n\nmap_homes_blackout\n```\n\n::: {.cell-output-display}\n![](texas_blackout_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### Verify an estimate of the number of homes in Houston that lost power\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count the number of homes that lost power\nlength(homes_blackout$fclass)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 157970\n```\n\n\n:::\n:::\n\n\nThe estimated number of houses that lost power is 157,970. I used the `st_intersects` operation, which considers homes even if they are only partially within the blackout area.\n\n## Identify the census tracts likely impacted by blackout\n\nJoin the census geometry with the median income data (texas_income)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Left join geometry and median income layers\ninc_geom <- left_join(texas_geom, texas_income, by = \"GEOID_Data\") %>% \n  st_transform(crs = \"epsg:3083\")\n```\n:::\n\n\nTransform Houston bounding box to match CRS\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transform CRS\nhouston_bbox <- houston_bbox %>% \n  st_transform(crs = \"epsg:3083\")\n```\n:::\n\n\nCrop census to Houston bbox area\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Crop income layer to the Houston bounding box\nhouston_income <- st_crop(inc_geom, houston_bbox) %>% \nst_make_valid() %>% \n  st_transform(houston_income, crs = \"epsg:3083\")\n```\n:::\n\n\n### Map of the census tracts in Houston that lost power\n\nCheck CRS compatibility before performing spatial operations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Verify that both datasets use the same CRS and add a stop error if they don't\nif(st_crs(houston_income) != st_crs(homes_blackout)){\n    stop(\"coordinate reference systems must match to join datasets\")}\n```\n:::\n\n\nUse `st_intersects` to find the census tracts that overlap with the homes affected by the blackout, including those partly inside the affected area.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Intersect census tracts with blackout areas\nhomes_census_blackout <- houston_income[homes_blackout,\n                               op = st_intersects]\n```\n:::\n\n\nMap of the spatial distribution of median household income across census tracts that experienced blackout in Houston.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create map showing median income for blackout-affected census tracts\ntm_shape(homes_census_blackout) +\n  tm_fill(\n    col = \"B19013e1\",\n    palette = \"Reds\",              \n    title = \"Median Income\") + \n tm_basemap(server = \"OpenStreetMap\", alpha = 0.7) +\n tm_graticules() +\n tm_title(text = \"Median Income by Census Tract for Houses\n          Affected by the Blackout in Houston\" )\n```\n\n::: {.cell-output-display}\n![](texas_blackout_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n## Find census tracts that did not experience blackout\n\nCreate combined dataset with blackout status for all census tracts\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compare all Houston tracts against those identified with blackouts,\n# Remove geometry and select only income and status variables\ncensus_combined <- houston_income %>%\n  mutate(blackout_status = if_else(GEOID_Data %in% homes_census_blackout$GEOID_Data, \n                                   \"Blackout\", \"No Blackout\")) %>%\n  st_drop_geometry() %>%\n  dplyr::select(B19013e1, blackout_status) %>%\n  drop_na()\n```\n:::\n\n\nVisualize the distribution of median household income across census tracts to determine if the blackout disproportionately impacted certain socioeconomic groups.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot income distribution by blackout status\nggplot() +\n  geom_boxplot(data = census_combined,\n           aes(x = blackout_status, \n               y = B19013e1,\n               fill = blackout_status)) +\n  scale_x_discrete(labels=c(\"Blackout\", \"No Blackout\")) +\n  scale_fill_manual(values = c(\"#2955AA\", \"#F9cF66\"),\n                    name = \"Blackout Status\") +\n  labs(x = \"Affected Status\",\n       y = \"Median Income of Census Tract\",\n       title = \"Distribution of Median Income in Areas Affected \n       and Unaffected by Blackout in Houston\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](texas_blackout_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n## Conclusion and Next Steps\n\nThe results show that median household incomes are similar between census tracts that experienced blackouts and those that did not, suggesting that income level was not a strong factor in determining which areas lost power during the storm. However, we need to consider some limitations of this result, as they relate to the spatial scale and join methods used in our analysis. Some possible bias in the results may be related to the concentration of buildings in the central part of Houston affected by blackouts, as shown in the Homes Map, and the reliance on tract-level overlaps that generalize patterns and hide smaller spatial or demographic variations.\n\n## Data Citations\n\nHome - LAADS DAAC. (2017, February 22). Nasa.gov. https://ladsweb.modaps.eosdis.nasa.gov/\n\nDownload OpenStreetMap for OpenStreetMap Data Extracts \\| Geofabrik Download Server. (2025). Geofabrik Download Server. https://download.geofabrik.de/\n\nBureau, U. C. (2025, September 29). American Community Survey (ACS). Census.gov. https://www.census.gov/programs-surveys/acs\n\nDEITABASE. (2024, December 27). 2021 Texas Power Grid Failure – a preventable disaster. DEITABASE - a Community Resource for Merging DEI and CEE Education. https://limos.engin.umich.edu/deitabase/2024/12/27/2021-texas-power-grid-failure/\n",
    "supporting": [
      "texas_blackout_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}